\documentclass[handout, 12pt]{beamer}
%\documentclass[11pt]{beamer}

\input{preamble.tex}
\title[]{Latent Variable Methods for Batch Processes}
\subtitle[]{Learning from data}
\author[]{Instructor: Kevin Dunn \\{\tt kevin.dunn@connectmv.com}\\ http://connectmv.com}
\institute[]{}
\date[]{Course notes \copyright~ ConnectMV, Inc. \\ \vspace{1cm}{\footnotesize Presented at GSK, Mississauga, February 2011}}

\begin{document}
\begin{frame}
\titlepage
\end{frame}

\begin{frame}\frametitle{TODO}

	% High t1: lower JTempSP slope:  But, JtempSlope is between -0.15 and -0.05, so a lower JTempSlope implies 
	% operation toward -0.15, ie temperature decreases more rapidly for the good batches. This might appear conflicting with the w*1 line plot, which shows that higher values of temperature SP lead to better batches.  How can a batch with a steeper decreasing slope have high value of temperature SP?  Well, the key insight is that temperature SP is always going to END at the same temperature value at the end of phase 2.  Having a steeper, more negative slope, implies that the batch must start at a higher temperature earlier in the batch.  This agrees exactly with the w*1 line plot.
	% 
	% % To get:
	% R2X = ??, R2Y = ??, Q2Y = ?? for fullbatch analysis of FMC
	% 
	% ------------------------
	% 
	% List of figures
	% 
	% 1. Nature of batch data
	% 2. 4 trajectories from FMC
	% 3. PCA scores from the Y's
	% 4. DuPont Nylong data: 10 trajectories from a batch
	% 5. Z X and Y for landmarks (with dimensions)
	% 6. VIP plot for the PLS model 
	% 7. The PLS score plot for landmarks PLS model
	% 8. The PLS loadings plot for landmarks PLS model
	% 9. Unfolding the data: two ways
	% 10. Variance to be explained from the 2 unfoldings
	% 11 *. Collect and other variables : show how alignment happens
	% 12 *. Time utiliziation during the batch
	% 13. General structure of batch-wise unfolded data
	% 14. t1-t2 score plot for batch PLS
	% 15 w1 loading plot for PLS
	% 16. contribution plot between 2 batches

	% \section{The final words}
	% 
	% \begin{frame}\frametitle{Final words}
	% 	\vspace{3pt}
	% 
	% 	{\color{myOrange}\bf The three main sources of errors are due to:}
	% 	\begin{enumerate}
	% 		\item {\bf The modeller:} model formulation errors
	% 		\item {\bf The algorithm:} truncation/discretization errors
	% 		\item {\bf The computer:} round-off errors
	% 	\end{enumerate}
	% 
	% 	\begin{columns}
	% 		\column{.80\textwidth}
	% 		\begin{exampleblock}{}
	% 			\centering{In engineering applications, use \alert{double-precision or better} to mitigate the effect of round-off error}
	% 		\end{exampleblock}
	% 	\end{columns}
	% 
	% 	\vspace{5pt}
	% 	\visible<2->{
	% 		\begin{columns}
	% 			\column{.34\textwidth}
	% 
	% 			\column{.65\textwidth}
	% 			\alert{\bf Reading:}\\
	% 			\vspace{3pt}
	% 			\begin{itemize}
	% 				\item Chapter 3 in S. C. Chapra, and R. P. Canale, {\em ``Numerical Methods for Engineers''}, McGraw Hill, 5th/6th Edition
	% 				\item Wikipedia article on \textbf{\texttt{Floating point}} is well-written
	% 				\item \href{http://docs.sun.com/source/806-3568/ncg_goldberg.html}{What every computer scientist should know about floating-point arithmetic}
	% 			\end{itemize}
	% 		\end{columns}
	% 	}
	% \end{frame}


\begin{itemize}
	\item	Adjust interline spacing  \hfill {\color{myOrange} $\leftarrow$ typical in practice!}
\end{itemize}
\end{frame}

\begin{frame}\frametitle{Interpreting score plots: \(t_1, t_2, \ldots \)}

\begin{itemize}
	\item	Shown as scatter plot or time-series plot

	\item	Each point in plot is an observation

	\item	\(t_1\) explains more than \(t_2\); i.e. pay more attention to lower scores

		\begin{itemize}
			\item	observations that are similar appear close together in all scores
			\item	\emph{colour code} score plots by another variables: makes plot more informative
		\end{itemize}

	\item	look for \textbf{clusters} and \textbf{patterns} to learn from data
\end{itemize}
\end{frame}

\begin{frame}\frametitle{Interpreting loading plots: \( p_1, p_2, \ldots \)}

\begin{itemize}
	\item	Shown as bar plots or scatter plots

	\item 	One point per variable in the model
	
		\begin{itemize}
			\item value of: \(\pm 0.8 vs \pm 0.6\) are both important
			\item value of: \(\pm 0.3 vs \pm 0.1\) are both quite small			
		\end{itemize}

	\item 	Each point in plot is an observation

	\item 	\(t_1\) explains more than \(t_2\); i.e. pay more attention to lower scores

		\begin{itemize}
			\item	observations that are similar appear close together in all scores
			\item 	\emph{colour code} score plots by another variables ] makes plot more informative
		\end{itemize}

	\item 	look for \textbf{clusters} and \textbf{patterns} to learn from data
\end{itemize}
\end{frame}

%-------------------------------------------------
\begin{frame}\frametitle{Outline}
\tableofcontents
\end{frame}
%-------------------------------------------------

%-------------------------------------------------
% Sources and resources
%-------------------------------------------------
\begin{frame}\frametitle{Sources and resources}

These notes are based on ConnectMV's experience with batch systems, but also the extensive research into batch data analysis done at McMaster University

\begin{enumerate}

	\item	Nomikos, ``Statistical Process Control of Batch Processes'', Ph.D thesis, McMaster University, 1995, {\scriptsize http://digitalcommons.mcmaster.ca/opendissertations/1667/}
	
	\item	Garcia-Mu\~noz, ``Batch process improvement using latent latent variable methods'', Ph.D thesis, McMaster University, 2004 {\scriptsize http://digitalcommons.mcmaster.ca/opendissertations/1596/}
	
	\item	Wold, Kettaneh-Wold, MacGregor, Dunn, ``Batch Process Modeling and MSPC'', \emph{Comprehensive Chemometrics}, 2009, {\scriptsize http://dx.doi.org/10.1016/B978-044452701-1.00108-3}
\end{enumerate}
\end{frame}

%-------------------------------------------------
\section{What do we learn from our data?}
%-------------------------------------------------

\begin{frame}\frametitle{What do we learn from our data?}

\begin{enumerate}
	\item {\bf \color{myGreen}Improve/confirm} process understanding
	
		 How do we learn from our data?
\begin{itemize}

	\item	see which variables behave similarly (clustering) \pause
	\item	confirm which phenomena have greatest effect in the data 
	\begin{itemize}
		\item	high variability appears in first LVs
		\item	lower variability phenomena later
	\end{itemize}\pause

	\item	which variables have most strong influence on variability in that component
	\begin{itemize}
		\item variables with high loadings
	\end{itemize}\pause

	\item	interpret latent variables
	\begin{itemize}
		\item	sometimes we can
		\item	helps us when we think in latent variable space
	\end{itemize}
\end{itemize}
\end{enumerate}
\end{frame}

\begin{frame}\frametitle{What do we learn from our data?}

\begin{enumerate}
	\setcounter{enumi}{1}
	\item {\bf \color{myGreen}Troubleshooting}
	\begin{itemize}
		\item 	confirm a known problem occurred (SPE, \( T^2 \), \( t_a \))
		\item 	use contribution plots to diagnose
		\begin{itemize}
			\item 	what went wrong?
			\item 	when did it go wrong (batch)? 
		\end{itemize}\pause
		
		\item 	use interpretation of \( t_1, t_2 \) to explain high/low score values\pause
		\item 	use engineering judgement to fix problems from insight gained
	\end{itemize}
\end{enumerate}
\end{frame}
	
\begin{frame}\frametitle{What do we learn from our data?}

\begin{enumerate}
	\setcounter{enumi}{2}
	\item {\bf \color{myGreen}Improve/optimize} a process
	\begin{itemize}
		\item 	how can we move in the latent variable space?
		\item 	what are the causal variables to adjust to move in \( t_1, t_2, \ldots \)
		\item 	how do we do latent variable DOE's to fill in gaps
	\end{itemize}	
	These all rely on the concept of \alert{``model inversion''}
\end{enumerate}
\end{frame}

\begin{frame}\frametitle{What do we learn from our data?}

\begin{enumerate}
	\setcounter{enumi}{3}
	\item {\bf \color{myGreen}Predictive modelling} 
	\begin{itemize}
		\item 	rely on PLS models
		\item 	e.g. inferential sensors provide real-time prediction of \( \mathbf{Y} \), our final quality attributes
		\begin{itemize}
			\item 	PLS handles colinearity, missing values, noisy \( \mathbf{X} \)-variables
			\item 	these 3 issues cannot be dealt with in ordinary least squares
		\end{itemize}
	\end{itemize}	
\end{enumerate}
\end{frame}

\begin{frame}\frametitle{What do we learn from our data?}

\begin{enumerate}
	\setcounter{enumi}{4}
	\item {\bf \color{myGreen}Process monitoring} 
	\begin{itemize}
		\item 	build a model from ``in control'' operation: make sure we remain there
		\item 	don't need to take extra action if we remain in that space
		\item 	do adjust process if trending out of space; we have
		\begin{itemize}
			\item 	SPE, \( T^2 \) and \( t_a \) score limits to monitor against
		\end{itemize}
		
		\item 	use contribution plots to diagnose problems
	\end{itemize}	
\end{enumerate}
\end{frame}

\begin{frame}\frametitle{What do we learn from our data?}

\begin{enumerate}
	\setcounter{enumi}{4}
	\item 	{\bf \color{myGreen}Process monitoring} (cont'd)	

	\vspace{10pt}	
			Advantages over \emph{univariate} monitoring:
		
			\begin{itemize}
				\item 	we monitor \textbf{many} raw variables with summarized scores, SPE, and \( T^2 \)
				\item 	i.e. we actually have \emph{fewer} control charts with multivariate monitoring
				\item 	multivariate charts interpreted in the same way as univariate charts
				\item 	i.e. no extra operator training required
				\item 	ordinary Shewhart charts do not give any help with diagnosis
			\end{itemize}	
\end{enumerate}
\end{frame}

\begin{frame}\frametitle{Tools to learn from our data}

\begin{enumerate}
	\item 	\alert{Generic}: applicable to all types of processes
	\item 	\alert{Informative}: easy to use by untrained staff for decision making
		\begin{itemize}
			\item clear and quick action possible
		\end{itemize}
	\item 	\alert{Simple to implement}: straightforward calculations and fast
\end{enumerate}

\vspace{1cm}

\begin{exampleblock}{}<2->
\centering{\large{\color{myOrange} Latent variable methods meet these criteria}}
\end{exampleblock}
\end{frame}

%-------------------------------------------------
\section{General multivariate review}
%-------------------------------------------------

\begin{frame}\frametitle{Quick review of multivariate concepts}

\begin{itemize}
	\item	High dimensionality in data we collect, e.g. NIR spectra
			\begin{center}
				\includegraphics[width=5cm]{images/high-dimensionality-data.jpg}
			\end{center}
			
			
	\item	high correlation between the variables (duplicate info)
	
			\begin{columns}
				\begin{center}
					\includegraphics[width=5cm]{images/high-dimensionality-data.jpg}
				\end{center}
				
			\end{columns}
			
\end{itemize}
\end{frame}

%-------------------------------------------------
\section{Batch systems}
%-------------------------------------------------
% Related concepts: phases, Z, trajectories, alignment, recipes, operators, manual steps, unfolding, charge reactor

\begin{frame}\frametitle{Batch systems: concepts and unique features}

\begin{itemize}
	\item 	Start point, an end point, and time-based evolution of tags (variables) in between 
	
	\item 	Operate essentially in open-loop i.t.o. final quality attributes (FQAs).  Basic, low-level feedback. \pause
	
	\item 	Quality measurements made afterwards, usually in a lab
	
			\begin{itemize}
				\item	used to decide batch disposition
				\item	often used to adjust next batch (batch-to-batch control)
			\end{itemize}\pause
			
	\item	Sequenced very accurately
	
	\item	Phase-based sequencing

\end{itemize}
\end{frame}

\begin{frame}\frametitle{Batch systems: concepts and unique features}

\begin{itemize}
	
	\item	Nonlinear relationship between variables; relationship changes with time \pause
	
	\item	Poor mechanistic models available (understandable)
	
			\begin{itemize}
				\item	continuous: one or two things happening all the time
				\item	batch: series of phases/events and relationships differ between (and within!) phases
			\end{itemize} \pause
			
	\item 	Past history within a batch affects the future
	
			\begin{itemize}
				\item	initial conditions: affect trajectories and FQAs								
				\item	trajectory changes from operator affect FQAs
				\item	actions taken can affect some period or all of batch, or,
				\item	even have no effect - relevant when monitoring a batch
			\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}\frametitle{Batch systems: terminology for these notes}

\begin{description} 
	
	\item[ \( N \): number of batches] 
	
		\begin{itemize}
			\item	literature uses \( I \)
		\end{itemize}
		
	\item[\( K \): number of tags] 
	
		\begin{itemize}
			\item	 literature uses \( J \)
		\end{itemize}
	
	\item[\( J \): number of time steps, ] 
	
		\begin{itemize}
			\item	 literature uses \( K \)
		\end{itemize}
\end{description}

We aim for consistency with general latent variable methods: \( N \times K \times J \)

\begin{center}
	\includegraphics[width=7.2cm]{images/batch-data-cube.png}
\end{center}

\end{frame}

\begin{frame}\frametitle{Batch systems: data representation (Excel, MATLAB)}

When retrieving batch data from computerized systems:
\begin{itemize}
	\item	One batch per sheet in a spreadsheet, with batch ID
			
			\includegraphics[scale=0.75]{images/batches-in-spreadsheets.png}
	
	\item	One batch per CSV file
	
	\item	Stacked batches in a single file (common)
	
			\begin{itemize}
				\item	unaligned data must also include a batch ID column
				
				\item	if phases, also include a phase ID column within each batch (not shown)
			\end{itemize}
	
			\todo{5. Stacked batches example}
\end{itemize}
MATLAB can handle all these formats
\end{frame}

\begin{frame}\frametitle{Batch systems: data representation (data cubes)}
	
	\begin{itemize}
		\item	It is very common that the time-dimension, \( J \), is unequal				
	\end{itemize}
	
	\todo{6. Ragged cube}
	
	We deal later with alignment (equalizing the time-dimension for all batches) 
\end{frame}

\begin{frame}\frametitle{Batch systems: visualize the trajectory data}
	
	\begin{columns}
		\column{.40\textwidth}
			\alert{\textbf{Unaligned data} }
 			\vfill
			\includegraphics[height=0.8\textheight]{images/unaligned-trajectories-many-batches.png}
			% From Cecilia Rodrigues thesis, used with permission (see gmail email in February 2011)
		
		\column{.60\textwidth}
			\alert{\textbf{Aligned data}}
			\vfill
			\includegraphics[height=0.8\textheight]{images/aligned-trajectories-many-batches-yeast.png}
			% Using rev 85:95b49ee15280 			
			% data = load('/Users/kevindunn/ConnectMV/Courses/Batch/datasets/yeast/yeast-data.mat');
			% b.tagNames = {'Ethanol', 'Temperature', 'Molasses', 'NH3 in feed', ...
			%               'Air flow', 'Tank level', 'pH'};
			% b.batchnames = {'rB','rC','rI','rM','rN','rQ','rR','rT','rV','rX','rZ', ...
			%                'ra','rb_1','rc_1','rd','re','rf','rg','rh','ri_1','nA', ...
			%                'tD','nG','nH','tJ','nL','nO','tP','nU','nY','rj','rk','rl'};
			% b.nBatches = 33;
			% batch_X = block(data.X, 'X', 'batch', 'tagNames', b.tagNames, 'nBatches', b.nBatches);
			% plot(batch_X, 'raw', 2, 3) % but used a limited set
	\end{columns}
	\todo{Add software instruction}	
\end{frame}

%-------------------------------------------------
\section{Batch analysis using feature extraction}
%-------------------------------------------------

\begin{frame}\frametitle{Feature extraction methods: overview}

\begin{itemize}
	\item	Unaligned data can be a challenge (more later).
	
	\item	One alternative to alignment, if we want to get started right away: 
	
			\begin{itemize}
				\item	{\color{myOrange}{\emph{extract features}}} from each phase in each batch
				
				\item	assemble features within a row
				
				\item	build ordinary PCA on \( \mathbf{X_f} \) or PLS: \( \left\{ \mathbf{Z} \,\,\text{and}\,\, \mathbf{X_f}\right\} \stackrel{\text{PLS}}{\longmapsto} \mathbf{Y} \)
			\end{itemize}
			
			\todo{8. Features}
\end{itemize}
\end{frame}

\begin{frame}\frametitle{Which features to extract}

\begin{itemize}
	\item	Extract {\color{myGreen}{\emph{within each phase}}} or within {\color{myGreen}{\emph{specified windows}}}. 
	
	\item	Extract for one, some, or \textbf{all} tags:
\end{itemize}\pause

\begin{itemize}
	\item	average value \hfill {\color{myOrange} $\leftarrow$ easiest, most useful feature}
	\item 	median value
	\item	integrated area under a tag (often makes engineering sense)
	\item	standard deviation, (useful if tag should be constant)
	\item	slope of curve\pause
	\item	energy or mass balance calculation over a phase
	 		\begin{itemize}
	 			\item	e.g. heat released by a reaction should be taken up by the cooling water
	 			\item	an imbalance can point out a problematic batch
	 		\end{itemize} \pause
	\item	value of a trajectory at start/end of phase
	\item	total time for a phase to complete (goes into \( \mathbf{Z} \))
\end{itemize}
\end{frame}

\begin{frame}\frametitle{How to use feature-based models}

\begin{itemize}
	\item	Many features extracted: often \( \sim \) 80 to 100 columns; many are not useful
	
	\item	Used in an ordinary PCA or PLS.  All the usual tools apply:
	
			\begin{itemize}
				\item	VIP: finds most import variables for explaining FQAs \( (\mathbf{Y}) \)
				
				\item	loadings and weights: used to interpret any clusters in the scores
				
				\item	\( R^2 \) per variable, small weights: eliminate less useful features
			\end{itemize}\pause
	
	\item	Learn about the batch: {\small e.g.: variability in cooling water temperature related to poor FQA}
	
	\item	Troubleshooting an unusual batch 

	\item	By extension, use troubleshooting information to improve future batches \pause
	
	\item	Can be used for monitoring: we'll come back to this
\end{itemize}
\end{frame}

\begin{frame}\frametitle{Disadvantages of feature-based models}

\begin{itemize}
	\item	Smoothly varying trajectories within a phase
	
			\begin{itemize}
				\item	no distinct features and hard to quantify
			\end{itemize}
			
		\todo{9. Nylon trajectories}
	
	\item	Depends on engineer's prior knowledge
	
	\item	Subtle defects and broken correlations between variables 
	
			\begin{itemize}
				\item	hard/impossible to detect and quantify
			\end{itemize}
			
			\todo{10. plot of subtle defect }

	\item	Feature value may not exist in an abnormal batch: so it's missed
	
\end{itemize}
\end{frame}
\item 

\begin{frame}\frametitle{Class example: using feature-based models}

\begin{itemize}
	\item	Features already extracted
	
	\item	This batch process works well, because there are 4 distinct phases and ``sharp'' trajectories
	
			\todo{11. FMC raw data for 1 batch}
	
	\item	Features:
	
			\begin{itemize}
				\item	\todo{LIST OF FEATURES}
			\end{itemize}
\end{itemize}

\todo{12. FMC features: VIP plot}

\todo{13: FMC features: score plot}

\todo{Rest of FMC example case study here}

\end{frame}
%-------------------------------------------------
\section{Batch analysis via direct PCA and PLS}
%-------------------------------------------------

\begin{frame}\frametitle{Batch systems: simple definition}

\begin{exampleblock}{Simplest definition}
\centering{\large{\textbf{A batch system}: group of the \alert{\emph{same variables}}, gathered over a period of \alert{\emph{time}}}}
\end{exampleblock}
	
\begin{center}
\includegraphics[width=6cm]{images/batch-system.png}	
\end{center}

\end{frame}	

\begin{frame}\frametitle{Batch systems: changing relationship}

	\textbf{Batch system}: group of the \emph{same variables}, gathered over a period of \emph{time}.  Why not just use ordinary PCA or PLS:

	\begin{center}
		\includegraphics[width=2.4cm]{images/batch-illustrate-unusual-unfolding.png}
	\end{center}


	\begin{itemize}
		\item 	PCA is invariant to row order: 
		\begin{itemize}			
			\item	can shuffle rows, still get same model
			\item 	explain how rows are related to each other
			\item 	each row is assumed independent of the others
			\item 	summarize relationship between variables (columns)
		\end{itemize}
	\end{itemize}

	\begin{exampleblock}{Key issue}
	In \textbf{batch systems}: relationship between variables \alert{changes during the batch}
	\end{exampleblock}
\end{frame}

\begin{frame}\frametitle{Batch systems: changing relationship}

\begin{enumerate}
	\item Relationship between variables change within a batch 
			\begin{itemize}
				\item 	Entry and exit temperatures in a batch dryer correlate (move together) at the end of the batch. 
				\item 	At start of the batch there is little relationship: heat used to evaporate moisture	
			\end{itemize}\pause

	
	\item Past history of a batch affects future behaviour (``integrating system'')
	
			\begin{itemize}
				\item 	Unfold batch data as shown above: cannot capture that ``past effect'' on future rows.  Why?
				\item  	Recall: each row is independent in PCA and PLS
			\end{itemize}

\end{enumerate}
\end{frame}

\begin{frame}\frametitle{Batch systems: changing relationship}
\begin{enumerate}
	\setcounter{enumi}{2}
	\item 	Predictive modelling is harder by unfolding this way

			\begin{center}
				\includegraphics[width=3.5cm]{images/batch-illustrate-unusual-unfolding-with-Y.png}
			\end{center}
			
		
			\begin{itemize}
				\item 	What do we use as the \( \mathbf{Y} \) matrix in this case?
				\item 	Many elaborate schemes proposed in literature.			
			\end{itemize}
		
	\item 	Simple solution: arrange data so that each batch is within a row
	
			\begin{itemize}
				\item 	There are some issues with this  (alignment, real-time monitoring)
				\item 	In general, these issues can be addressed effectively
			\end{itemize}
\end{enumerate}
\end{frame}


%-------------------------------------------------
\section{Batch Monitoring}
%-------------------------------------------------

\begin{frame}\frametitle{Batch monitoring overview}

\begin{enumerate}
	\item 	Univariate process monitoring recap
	
	\item	Multivariate process monitoring recap
	
	\item	Batch monitoring
	
		\begin{itemize}
			\item	feature-based monitoring			
			\item	building the monitoring model for real-time use (selecting phase I data)
			\item	monitoring for acceptance / end-of-batch release
			\item	endpoint detection monitoring
			\item	multiblock monitoring: using information in \( Z \)			
			\item	alignment issues
			\item 	When does LVM monitoring fail?
		\end{itemize}
\end{enumerate}
\end{frame}

\begin{frame}[label=featuremonitoring]\frametitle{Feature-based monitoring}
	
	\begin{itemize}
		\item	\textbf{Advantage}: avoids alignment issues
		
		\item	\textbf{Disadvantage}: 
		
				\begin{itemize}
					\item	have to wait till end of each phase
					
					\item	not sensitive to subtle faults (see earlier notes on feature extraction)
				\end{itemize}\pause
	\end{itemize}
	
	{\color{myOrange}{Approach}}
	\begin{itemize}
		\item	We've extracted features from the (unaligned) trajectories
		
		\item	Use LVM to reduce the number of features to those that are meaningful \pause
		
		\item	At the end of each phase: calculate features and monitor using usual tools: \( T^2 \) and SPE and their contribution plots
		
		\item	Use missing data handling methods for features not yet available
		
	\end{itemize}
\end{frame}

\begin{frame}\frametitle{Multiblock monitoring: what goes in \( Z \)?}

\begin{block}{}
Any relevant information that is constant over the batch 
\end{block}

\begin{itemize}
	\item	feed stock quality and composition (your lab values, supplier's spec sheet)	
	\item	idle time between phases / initial setup time
	\item	summary information of upstream operations
			\begin{itemize}
				\item	averages				
				\item	latent variable summary: scores
			\end{itemize}
	\item	desired recipe	
	\item	alignment information from \( \mathbf{X}_\text{batch} \)
	\item	operator or shift information (coded)
	\item	day of batch, month (e.g. can show a seasonal effect)
	\item	raw material supplier (coded)
	\item	properties in batch tank after adding material: pH, NIR spectra, colour, temperature
	\item	ambient conditions: temperature, humidity, and so on
\end{itemize}
\end{frame}

\begin{frame}\frametitle{When does LVM monitoring fail?}

\begin{description} 
	
	\item[\color{myGreen}{\textbf{Lack of stability}}] 
	
		\begin{itemize}
			\item	Reference data (phase I) is representative of normal operation
			
			\item	but if process has shifted too much, monitoring will raise too many false alarms.
			
			\item	If something major has changed: acquire new data and rebuild model.
		\end{itemize}
		
	\item[\color{myGreen}{\textbf{Unobservable events}}] 
	
		\begin{itemize}
			\item Events you want to detect must be \emph{detectable} in the raw data.
		
			\item	Not all quality-related problems are observable in the data.
		\end{itemize}
		
\end{description}
\end{frame}

%-------------------------------------------------
\section{Summary so far}
%-------------------------------------------------

\begin{frame}\frametitle{Value from batch process data}
\begin{enumerate}
	\item 	Learning more / confirming relationships
		
			\begin{itemize}
				\item 	understand between batch variation (overall scores, \( T^2 \), and SPE)
				\item 	understand within batch variation (instantaneous scores, \( T^2 \), and SPE)
			\end{itemize}
			
	\item 	Troubleshoot problems within a batch
	\item 	Optimize and improve: possible, but less likely in pharmaceutical applications
	\item 	Predictions: final quality attributes, endpoint
	\item 	Monitoring: can allow for early release to next stage
	
\end{enumerate}
\end{frame}

\end{document}

